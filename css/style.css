/* ==========================================================================
   VARIABLES (Theme: Kanagawa)
   ========================================================================== */
:root {
  /* Base Colors */
  --bg-main: #1f1f28;      /* SumiInk1: 深い背景色 */
  --fg-main: #dcd7ba;      /* OldWhite: メインの文字色 */
  
  /* UI Components */
  --bg-status: #2a2a37;    /* SumiInk3: ステータスライン等 */
  --bg-highlight: #2d2c2d; /* Sumimi: 行のハイライト */
  --cursor-bg: #c8c093;    /* RoninYellow: カーソル色 */
  --bg-column: rgba(255, 255, 255, 0.05);
  --char-width: 1ch;
  --cursor-col: 0;

  /* Mode Accent Colors */
  --accent-blue: #7e9cd8;    /* CrystalBlue: Normal */
  --accent-green: #98bb6c;   /* AutumnGreen: Insert */
  --accent-purple: #957fb8;  /* OniViolet: Visual */
  --accent-sakura: #d27399;  /* SakuraPink: Visual Line */
  --accent-crystal: #7fb4ca; /* LightBlue: Visual Block (少し色味を調整) */
  --accent-red: #c34043;     /* AutumnRed: Replace / Error */
  --accent-yellow: #e6c384;  /* CarpYellow: Command */
  
  /* Debugging */
  --debug-border: transparent; /* 開発時は 2px solid #000 に変更 */
}

/* ==========================================================================
   GLOBAL STYLES
   ========================================================================== */
body {
  margin: 0;
  overflow: hidden;
  background-color: var(--bg-main);
  color: var(--fg-main);
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', monospace;
}

#app {
  display: grid;
  height: 100vh;
  /* Header / Editor / StatusLine / CommandLine */
  grid-template-rows: auto 1fr 30px 2.5rem;
}

/* Test/Debug Border - 一括管理 */
header, #workspace, #statusline, #commandline {
  border: var(--debug-border);
}

/* ==========================================================================
   EDITOR AREA
   ========================================================================== */
#workspace {
  overflow: hidden;
}

#editor {
  height: 100%;
  overflow-y: hidden;
  overflow-x: hidden;
  font-size: 18px;
  line-height: 1.5;
}
#ditor::-webkit-scrollbar {
  display: none;
}
#editor {
  -ms-overflow-style: none;  /* IE, Edge */
  scrollbar-width: none;     /* Firefox */
}
/* 行全体のスタイル */
.line {
  display: flex;       /* 番号と本文を横並びに */
  white-space: pre;    /* 空白を維持（typeのインデント用） */
  min-height: 1.5em;   /* 空行でも高さを確保 */
  align-items: center; /* 垂直方向の中央揃え（お好みで） */
  line-height: 1.5;
}
/* 行番号エリアのスタイル */
.line-number {
  flex-shrink: 0;      /* 横幅を固定 */
  padding-right: 1rem; /* 文字との間のマージン */
  text-align: right;   /* 数字を右寄せ */
  color: #54546d;      /* Kurebi (暗めの色) */
  user-select: none;   /* コピーされないようにする */
}
.fold-column {
  width: 1.5rem;
  text-align: center;
  color: #727169; /* Kurebi */
  flex-shrink: 0;
  cursor: pointer;
}
.line-number.active-number {
  color: var(--cursor-bg); /* RoninYellow: 視認性の高い黄色 */
  font-weight: bold;       /* 少し太くして強調するのもVimらしいです */
}

/* 本文エリア（必要であれば） */
.line-content {
  flex-grow: 1;
  min-width: 0;
  position: relative;
}
.line-content::after {
content: "";
  position: absolute;
  top: 0;
  left: 0;
  transform: translateX(calc(var(--cursor-col) * var(--char-width)));
  width: var(--char-width);
  height: 100%;
  background-color: var(--bg-column);
  pointer-events: none;
  z-index: 0;
  opacity: 0; 
  visibility: hidden;
}
.show-cursorcolumn .line-content::after {
  opacity: 1;
  visibility: visible;
}
.line.active-line {
  background-color: var(--bg-highlight);
}

/* Cursor Style */
.cursor {
  display: inline-block;
  width: 1ch;
  background-color: var(--cursor-bg);
  color: var(--bg-main);
}

/* ==========================================================================
   STATUS LINE & MODES
   ========================================================================== */
#statusline {
  background-color: var(--bg-status);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 10px;
  font-size: 16px;
  font-weight: bold;
  transition: background-color 0.2s ease; /* モード切替を滑らかに */
}
#commandline {
  display: flex;
  align-items: center;
  padding: 0 10px;
  font-size: 18px;
  min-height: 1.5rem;
  white-space: pre;
  font-family: monospace;
}
#commandline .cursor {
  background-color: var(--cursor-color, #ffffff);
  color: #000;
  display: inline-block;
  min-width: 0.6em;
}
.error-msg {
  color: #ffffff;
  background-color : var(--accent-red);
}
.info-msg {
  color: var(--fg-main);
}
/* Mode-Specific Styles (JSで付与されるクラス) */
#statusline.mode-normal       { background-color: var(--accent-blue);    color: var(--bg-main); }
#statusline.mode-insert       { background-color: var(--accent-green);   color: var(--bg-main); }
#statusline.mode-visual       { background-color: var(--accent-purple);  color: var(--bg-main); }
#statusline.mode-visual-line  { background-color: var(--accent-sakura);  color: var(--bg-main); }
#statusline.mode-visual-block { background-color: var(--accent-crystal); color: var(--bg-main); }
#statusline.mode-replace      { background-color: var(--accent-red);     color: var(--bg-main); }
#statusline.mode-command      { background-color: var(--accent-yellow);  color: var(--bg-main); }
